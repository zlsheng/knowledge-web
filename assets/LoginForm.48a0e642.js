var e,t,o=(e,t,o)=>new Promise(((a,s)=>{var n=e=>{try{l(o.next(e))}catch(t){s(t)}},r=e=>{try{l(o.throw(e))}catch(t){s(t)}},l=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,r);l((o=o.apply(e,t)).next())}));import{h as a,B as s,I as n,g as r,k as l,o as i,l as u}from"./index.9eab7d25.js";import{C as c,F as d,I as m}from"./index.16147537.js";import{C as f,R as g}from"./index.87ed27e4.js";import"./index.5eb2f555.js";import{f as p,e as v,G as y,d as h,r as x,o as C,A as I,Y as S,Q as w,R,k as L,v as E,c as F,S as D,_,q as b,F as O}from"./vendor.445a818e.js";import"./_baseIteratee.4c28a80c.js";import"./get.0c0a01c7.js";import"./findIndex.2cb8eacb.js";import"./responsiveObserve.c545f1cc.js";(t=e||(e={}))[t.LOGIN=0]="LOGIN",t[t.REGISTER=1]="REGISTER",t[t.RESET_PASSWORD=2]="RESET_PASSWORD",t[t.MOBILE=3]="MOBILE",t[t.QR_CODE=4]="QR_CODE";const P=p(e.LOGIN);function j(e){return[{required:!0,message:e,trigger:"change"}]}var k=h({name:"LoginForm",components:{[f.name]:f,[g.name]:g,Checkbox:c,Button:s,Form:d,FormItem:d.Item,Input:n,InputPassword:n.Password,Image:m},setup(){const{t:t}=a(),{notification:s}=u(),{prefixCls:n}=r("login"),c=l(),{setLoginState:d,getLoginState:m}=function(){function t(e){P.value=e}return{setLoginState:t,getLoginState:v((()=>P.value)),handleBackLogin:function(){t(e.LOGIN)}}}(),{getFormRules:f}=function(){const{t:e}=a(),t=v((()=>j(e("sys.login.accountPlaceholder")))),o=v((()=>j(e("sys.login.passwordPlaceholder")))),s=v((()=>j(e("sys.login.verifyCodePlaceholder"))));return{getFormRules:v((()=>{const e=y(t),a=y(s);return{account:e,password:y(o),verifyCode:a}}))}}(),g=p(),h=p(!1),S=x({url:""}),w=x({account:"",password:"",verifyCode:"",uuid:""}),{validForm:R}=function(e){return{validForm:function(){return o(this,null,(function*(){const t=y(e);if(t)return yield t.validate()}))}}}(g);i("Enter",F);const L=v((()=>y(m)===e.LOGIN));function E(){return o(this,null,(function*(){const e=yield c.getVerifyCode();S.url=e.image,w.uuid=e.uuid}))}function F(){return o(this,null,(function*(){const e=yield R();if(e)try{h.value=!0;const o=yield c.login(I({password:e.password,username:e.account,verifyCode:e.verifyCode,uuid:w.uuid}));o&&s.success({message:t("sys.login.loginSuccessTitle"),description:`${t("sys.login.loginSuccessDesc")}: ${o.username}`,duration:3})}finally{h.value=!1}}))}return C(E),{t:t,prefixCls:n,formRef:g,formData:w,getFormRules:f,handleLogin:F,loading:h,setLoginState:d,LoginStateEnum:e,getShow:L,images:S,getVerifyCode:E}}});k.render=function(e,t,o,a,s,n){const r=S("Input"),l=S("FormItem"),i=S("InputPassword"),u=S("Image"),c=S("Button"),d=S("Form");return w(),R(O,null,[L(F("h2",{class:"font-bold text-2xl xl:text-3xl enter-x text-center xl:text-left mb-6"},D(e.t("sys.login.signInFormTitle")),513),[[E,e.getShow]]),L(F(d,{class:"p-4 enter-x",model:e.formData,rules:e.getFormRules,ref:"formRef"},{default:_((()=>[F(l,{name:"account",class:"enter-x"},{default:_((()=>[F(r,{size:"large",value:e.formData.account,"onUpdate:value":t[1]||(t[1]=t=>e.formData.account=t),placeholder:e.t("sys.login.userName")},null,8,["value","placeholder"])])),_:1}),F(l,{name:"password",class:"enter-x"},{default:_((()=>[F(i,{size:"large",visibilityToggle:"",value:e.formData.password,"onUpdate:value":t[2]||(t[2]=t=>e.formData.password=t),placeholder:e.t("sys.login.password")},null,8,["value","placeholder"])])),_:1}),F(l,{name:"verifyCode",class:"enter-x"},{default:_((()=>[F(r,{size:"large",type:"number",value:e.formData.verifyCode,"onUpdate:value":t[3]||(t[3]=t=>e.formData.verifyCode=t),placeholder:e.t("sys.login.verifyCode")},{addonAfter:_((()=>[F(u,{width:110,height:30,src:e.images.url,preview:!1,onClick:e.getVerifyCode},null,8,["src","onClick"])])),_:1},8,["value","placeholder"])])),_:1}),F(l,{class:"enter-x"},{default:_((()=>[F(c,{type:"primary",size:"large",block:"",onClick:e.handleLogin,loading:e.loading},{default:_((()=>[b(D(e.t("sys.login.loginButton")),1)])),_:1},8,["onClick","loading"])])),_:1})])),_:1},8,["model","rules"]),[[E,e.getShow]])],64)};export default k;
