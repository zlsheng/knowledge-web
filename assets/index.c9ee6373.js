import{p as t,L as a,F as r,y as s,a3 as e}from"./index.9eab7d25.js";import{d as i,a as n,n as o,c}from"./vendor.445a818e.js";function l(){return(l=Object.assign||function(t){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t}).apply(this,arguments)}function d(t,a,r){return a in t?Object.defineProperty(t,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[a]=r,t}var f=e(i({name:"AAvatar",props:{prefixCls:t.string,shape:t.oneOf(a("circle","square")),size:{type:[Number,String],default:"default"},src:t.string,srcset:t.string,srcSet:t.string,icon:t.VNodeChild,alt:t.string,loadError:{type:Function}},setup:function(){return{configProvider:n("configProvider",s)}},data:function(){return{isImgExist:!0,isMounted:!1,scale:1,lastChildrenWidth:void 0,lastNodeWidth:void 0}},watch:{src:function(){var t=this;o((function(){t.isImgExist=!0,t.scale=1,t.$forceUpdate()}))}},mounted:function(){var t=this;o((function(){t.setScale(),t.isMounted=!0}))},updated:function(){var t=this;o((function(){t.setScale()}))},methods:{setScale:function(){if(this.$refs.avatarChildren&&this.$refs.avatarNode){var t=this.$refs.avatarChildren.offsetWidth,a=this.$refs.avatarNode.offsetWidth;0===t||0===a||this.lastChildrenWidth===t&&this.lastNodeWidth===a||(this.lastChildrenWidth=t,this.lastNodeWidth=a,this.scale=a-8<t?(a-8)/t:1)}},handleImgLoadError:function(){var t=this.$props.loadError;!1!==(t?t():void 0)&&(this.isImgExist=!1)}},render:function(){var t,a,s,e,i=this.$props,n=i.prefixCls,o=i.shape,f=i.size,h=i.src,u=i.alt,p=i.srcset,v=i.srcSet,g=r(this,"icon"),m=(0,this.configProvider.getPrefixCls)("avatar",n),x=this.$data,y=x.isImgExist,C=x.scale,b=(x.isMounted,d(t={},"".concat(m,"-lg"),"large"===f),d(t,"".concat(m,"-sm"),"small"===f),t),$=l(l(d({},m,!0),b),(d(a={},"".concat(m,"-").concat(o),o),d(a,"".concat(m,"-image"),h&&y),d(a,"".concat(m,"-icon"),g),a)),E="number"==typeof f?{width:"".concat(f,"px"),height:"".concat(f,"px"),lineHeight:"".concat(f,"px"),fontSize:g?"".concat(f/2,"px"):"18px"}:{},W=null===(e=(s=this.$slots).default)||void 0===e?void 0:e.call(s);if(h&&y)W=c("img",{src:h,srcset:p||v,onError:this.handleImgLoadError,alt:u},null);else if(g)W=g;else{if(this.$refs.avatarChildren||1!==C){var N="scale(".concat(C,") translateX(-50%)"),S={msTransform:N,WebkitTransform:N,transform:N},I="number"==typeof f?{lineHeight:"".concat(f,"px")}:{};W=c("span",{class:"".concat(m,"-string"),ref:"avatarChildren",style:l(l({},I),S)},[W])}else{W=c("span",{class:"".concat(m,"-string"),ref:"avatarChildren",style:{opacity:0}},[W])}}return c("span",{ref:"avatarNode",class:$,style:E},[W])}}));export{f as A};
