var e=Object.defineProperty,l=Object.prototype.hasOwnProperty,n=Object.getOwnPropertySymbols,t=Object.prototype.propertyIsEnumerable,o=(l,n,t)=>n in l?e(l,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[n]=t,a=(e,a)=>{for(var r in a||(a={}))l.call(a,r)&&o(e,r,a[r]);if(n)for(var r of n(a))t.call(a,r)&&o(e,r,a[r]);return e},r=(e,l,n)=>new Promise(((t,o)=>{var a=e=>{try{s(n.next(e))}catch(l){o(l)}},r=e=>{try{s(n.throw(e))}catch(l){o(l)}},s=e=>e.done?t(e.value):Promise.resolve(e.value).then(a,r);s((n=n.apply(e,l)).next())}));import{al as s,h as i,as as c,cr as u,cs as d,bB as p,az as f,aA as g,aT as h,Z as m,g as b,bW as v,by as y,ay as C,cn as F,bE as H,S as k,bY as M,bg as O}from"./index.9eab7d25.js";import{g as S,G as P,d as x,W as w,c as T,i as W,f as j,e as $,w as B,o as R,I as E,n as A,Y as N,a4 as _,Q as I,R as L,_ as V,k as D,$ as q,F as Y,a0 as z,x as X,q as G,S as Q,B as Z,y as J,a9 as K,a2 as U,r as ee,A as le}from"./vendor.445a818e.js";import{u as ne}from"./useWindowSizeFn.4826c9d6.js";import{F as te,a as oe}from"./FullscreenOutlined.b91c2893.js";const{t:ae}=i(),re={visible:s.bool,scrollTop:s.bool.def(!0),height:s.number,minHeight:s.number,draggable:s.bool.def(!0),centered:s.bool,cancelText:s.string.def(ae("common.cancelText")),okText:s.string.def(ae("common.okText")),closeFunc:Function},se=Object.assign({},re,{defaultFullscreen:s.bool,canFullscreen:s.bool.def(!0),wrapperFooterOffset:s.number.def(0),helpMessage:[String,Array],useWrapper:s.bool.def(!0),loading:s.bool,loadingTip:s.string,showCancelBtn:s.bool.def(!0),showOkBtn:s.bool.def(!0),wrapperProps:Object,afterClose:Function,bodyStyle:Object,closable:s.bool.def(!0),closeIcon:Object,confirmLoading:s.bool,destroyOnClose:s.bool,footer:Object,getContainer:Function,mask:s.bool.def(!0),maskClosable:s.bool.def(!0),keyboard:s.bool.def(!0),maskStyle:Object,okType:s.string.def("primary"),okButtonProps:Object,cancelButtonProps:Object,title:s.string,visible:s.bool,width:[String,Number],wrapClassName:s.string,zIndex:s.number});function ie(e){const l=(e,l)=>getComputedStyle(e)[l],n=n=>{if(!n)return;n.setAttribute("data-drag",P(e.draggable));const t=n.querySelector(".ant-modal-header"),o=n.querySelector(".ant-modal");t&&o&&P(e.draggable)&&(t.style.cursor="move",t.onmousedown=e=>{if(!e)return;const n=e.clientX,t=e.clientY,a=document.body.clientWidth,r=document.documentElement.clientHeight,s=o.offsetWidth,i=o.offsetHeight,c=o.offsetLeft,u=a-o.offsetLeft-s,d=o.offsetTop,p=r-o.offsetTop-i,f=l(o,"left"),g=l(o,"top");let h=+f,m=+g;f.includes("%")?(h=+document.body.clientWidth*(+f.replace(/%/g,"")/100),m=+document.body.clientHeight*(+g.replace(/%/g,"")/100)):(h=+f.replace(/px/g,""),m=+g.replace(/px/g,"")),document.onmousemove=function(e){let l=e.clientX-n,a=e.clientY-t;-l>c?l=-c:l>u&&(l=u),-a>d?a=-d:a>p&&(a=p),o.style.cssText+=`;left:${l+h}px;top:${a+m}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})};S((()=>{P(e.visible)&&P(e.draggable)&&c((()=>{(()=>{const t=document.querySelectorAll(".ant-modal-wrap");for(const o of Array.from(t)){if(!o)continue;const t=l(o,"display"),a=o.getAttribute("data-drag");"none"!==t&&(null===a||P(e.destroyOnClose))&&n(o)}})()}),30)}))}var ce=x({name:"Modal",inheritAttrs:!1,props:se,setup(e,{slots:l}){const{visible:n,draggable:t,destroyOnClose:o}=w(e),r=p();return ie({visible:n,destroyOnClose:o,draggable:t}),()=>{let n;const t=a(a({},P(r)),e);return T(d,t,"function"==typeof(o=n=u(l))||"[object Object]"===Object.prototype.toString.call(o)&&!W(o)?n:{default:()=>[n]});var o}}});const ue=Symbol();function de(){return g(ue)}var pe=x({name:"ModalWrapper",components:{ScrollContainer:h},inheritAttrs:!1,props:{loading:s.bool,useWrapper:s.bool.def(!0),modalHeaderHeight:s.number.def(57),modalFooterHeight:s.number.def(74),minHeight:s.number.def(200),height:s.number,footerOffset:s.number.def(0),visible:s.bool,fullScreen:s.bool,loadingTip:s.string},emits:["height-change","ext-height"],setup(e,{emit:l}){const n=j(null),t=j(null),o=j(0),a=j(0);let s=0;ne(c.bind(null,!1)),f({redoModalHeight:c},ue);const i=$((()=>({minHeight:`${e.minHeight}px`,height:`${P(o)}px`})));function c(){return r(this,null,(function*(){if(!e.visible)return;const a=P(n);if(!a)return;const r=a.$el.parentElement;if(r){r.style.padding="0",yield A();try{const n=r.parentElement&&r.parentElement.parentElement;if(!n)return;const a=getComputedStyle(n).top,i=Number.parseInt(a);let c=window.innerHeight-2*i+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;i<40&&(c-=26),yield A();const u=P(t);if(!u)return;yield A(),s=u.scrollHeight,e.fullScreen?o.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight-28:o.value=e.height?e.height:s>c?c:s,l("height-change",P(o))}catch(i){}}}))}return S((()=>{e.useWrapper&&c()})),B((()=>e.fullScreen),(e=>{c(),e?a.value=o.value:o.value=a.value})),R((()=>{const{modalHeaderHeight:n,modalFooterHeight:t}=e;l("ext-height",n+t)})),E((()=>{})),{wrapperRef:n,spinRef:t,spinStyle:i,scrollTop:function(){return r(this,null,(function*(){A((()=>{var e;const l=P(n);l&&(null==(e=null==l?void 0:l.scrollTo)||e.call(l,0))}))}))},setModalHeight:c}}});pe.render=function(e,l,n,t,o,a){const r=N("ScrollContainer"),s=_("loading");return I(),L(r,{ref:"wrapperRef"},{default:V((()=>[D(T("div",{ref:"spinRef",style:e.spinStyle,"loading-tip":e.loadingTip},[q(e.$slots,"default")],12,["loading-tip"]),[[s,e.loading]])])),_:3},512)};var fe=x({name:"ModalClose",components:{FullscreenExitOutlined:te,FullscreenOutlined:oe,CloseOutlined:m},props:{canFullscreen:s.bool.def(!0),fullScreen:s.bool},emits:["cancel","fullscreen"],setup(e,{emit:l}){const{prefixCls:n}=b("basic-modal-close");return{getClass:$((()=>[n,`${n}--custom`,{[`${n}--can-full`]:e.canFullscreen}])),prefixCls:n,handleCancel:function(){l("cancel")},handleFullScreen:function(e){null==e||e.stopPropagation(),null==e||e.preventDefault(),l("fullscreen")}}}});fe.render=function(e,l,n,t,o,a){const r=N("FullscreenExitOutlined"),s=N("FullscreenOutlined"),i=N("CloseOutlined");return I(),L("div",{class:e.getClass},[e.canFullscreen?(I(),L(Y,{key:0},[e.fullScreen?(I(),L(r,{key:0,role:"full",onClick:e.handleFullScreen},null,8,["onClick"])):(I(),L(s,{key:1,role:"close",onClick:e.handleFullScreen},null,8,["onClick"]))],64)):z("",!0),T(i,{onClick:e.handleCancel},null,8,["onClick"])],2)};var ge=x({name:"BasicModalFooter",props:se,emits:["ok","cancel"],setup:(e,{emit:l})=>({handleOk:function(){l("ok")},handleCancel:function(){l("cancel")}})});ge.render=function(e,l,n,t,o,a){const r=N("a-button");return I(),L("div",null,[q(e.$slots,"insertFooter"),e.showCancelBtn?(I(),L(r,X({key:0},e.cancelButtonProps,{onClick:e.handleCancel}),{default:V((()=>[G(Q(e.cancelText),1)])),_:1},16,["onClick"])):z("",!0),q(e.$slots,"centerFooter"),e.showOkBtn?(I(),L(r,X({key:1,type:e.okType,onClick:e.handleOk,loading:e.confirmLoading},e.okButtonProps),{default:V((()=>[G(Q(e.okText),1)])),_:1},16,["type","onClick","loading"])):z("",!0),q(e.$slots,"appendFooter")])};var he=x({name:"BasicModalHeader",components:{BasicTitle:v},props:{helpMessage:{type:[String,Array]},title:s.string}});he.render=function(e,l,n,t,o,a){const r=N("BasicTitle");return I(),L(r,{helpMessage:e.helpMessage},{default:V((()=>[G(Q(e.title),1)])),_:1},8,["helpMessage"])};var me=x({name:"BasicModal",components:{Modal:ce,ModalWrapper:pe,ModalClose:fe,ModalFooter:ge,ModalHeader:he},inheritAttrs:!1,props:se,emits:["visible-change","height-change","cancel","ok","register"],setup(e,{emit:l,attrs:n}){const t=j(!1),o=j(null),s=j(null),i=j(0),c={setModalProps:function(e){if(o.value=F(P(o)||{},e),!Reflect.has(e,"visible"))return;t.value=!!e.visible},emitVisible:void 0,redoModalHeight:()=>{A((()=>{P(s)&&P(s).setModalHeight()}))}},u=J();u&&l("register",c,u.uid);const d=$((()=>a(a({},e),P(o)))),{handleFullScreen:p,getWrapClassName:f,fullScreenRef:g}=function(e){const l=j(!1);return{getWrapClassName:$((()=>{const n=P(e.wrapClassName)||"";return P(l)?`fullscreen-modal ${n} `:P(n)})),handleFullScreen:function(e){e&&e.stopPropagation(),l.value=!P(l)},fullScreenRef:l}}({modalWrapperRef:s,extHeightRef:i,wrapClassName:Z(d.value,"wrapClassName")}),h=$((()=>{const e=a(a({},P(d)),{visible:P(t),title:void 0});return a(a({},e),{wrapClassName:P(f)})})),m=$((()=>{const e=a(a({},n),P(h));return P(g)?y(e,"height"):e})),b=$((()=>{if(!P(g))return P(h).height}));return S((()=>{t.value=!!e.visible,g.value=!!e.defaultFullscreen})),B((()=>P(t)),(n=>{var t;l("visible-change",n),u&&(null==(t=c.emitVisible)||t.call(c,n,u.uid)),A((()=>{e.scrollTop&&n&&P(s)&&P(s).scrollTop()}))}),{immediate:!1}),{handleCancel:function(n){return r(this,null,(function*(){if(null==n||n.stopPropagation(),e.closeFunc&&C(e.closeFunc)){const l=yield e.closeFunc();t.value=!l}else t.value=!1,l("cancel")}))},getBindValue:m,getProps:h,handleFullScreen:p,fullScreenRef:g,getMergeProps:d,handleOk:function(){l("ok")},visibleRef:t,omit:y,modalWrapperRef:s,handleExtHeight:function(e){i.value=e},handleHeightChange:function(e){l("height-change",e)},handleTitleDbClick:function(l){e.canFullscreen&&(l.stopPropagation(),p(l))},getWrapperHeight:b}}});me.render=function(e,l,n,t,o,a){const r=N("ModalClose"),s=N("ModalHeader"),i=N("ModalFooter"),c=N("ModalWrapper"),u=N("Modal");return I(),L(u,X({onCancel:e.handleCancel},e.getBindValue),K({default:V((()=>[T(c,X({useWrapper:e.getProps.useWrapper,footerOffset:e.wrapperFooterOffset,fullScreen:e.fullScreenRef,ref:"modalWrapperRef",loading:e.getProps.loading,"loading-tip":e.getProps.loadingTip,minHeight:e.getProps.minHeight,height:e.getWrapperHeight,visible:e.visibleRef,modalFooterHeight:void 0===e.footer||e.footer?void 0:0},e.omit(e.getProps.wrapperProps,"visible","height","modalFooterHeight"),{onExtHeight:e.handleExtHeight,onHeightChange:e.handleHeightChange}),{default:V((()=>[q(e.$slots,"default")])),_:3},16,["useWrapper","footerOffset","fullScreen","loading","loading-tip","minHeight","height","visible","modalFooterHeight","onExtHeight","onHeightChange"])])),_:2},[e.$slots.closeIcon?void 0:{name:"closeIcon",fn:V((()=>[T(r,{canFullscreen:e.getProps.canFullscreen,fullScreen:e.fullScreenRef,onCancel:e.handleCancel,onFullscreen:e.handleFullScreen},null,8,["canFullscreen","fullScreen","onCancel","onFullscreen"])]))},e.$slots.title?void 0:{name:"title",fn:V((()=>[T(s,{helpMessage:e.getProps.helpMessage,title:e.getMergeProps.title,onDblclick:e.handleTitleDbClick},null,8,["helpMessage","title","onDblclick"])]))},e.$slots.footer?void 0:{name:"footer",fn:V((()=>[T(i,X(e.getProps,{onOk:e.handleOk,onCancel:e.handleCancel}),K({_:2},[U(Object.keys(e.$slots),(l=>({name:l,fn:V((n=>[q(e.$slots,l,n)]))})))]),1040,["onOk","onCancel"])]))},U(Object.keys(e.omit(e.$slots,"default")),(l=>({name:l,fn:V((n=>[q(e.$slots,l,n)]))})))]),1040,["onCancel"])};const be=ee({}),ve=ee({});function ye(){const e=j(null),l=j(!1),n=j("");const t=()=>{const l=P(e);return l||M("useModal instance is undefined!"),l};return[function(t,o){n.value=o,E((()=>{e.value=null,l.value=!1,be[P(n)]=null})),P(l)&&H()&&t===P(e)||(e.value=t,t.emitVisible=(e,l)=>{ve[l]=e})},{setModalProps:e=>{var l;null==(l=t())||l.setModalProps(e)},getVisible:$((()=>ve[~~P(n)])),redoModalHeight:()=>{var e,l;null==(l=null==(e=t())?void 0:e.redoModalHeight)||l.call(e)},openModal:(e=!0,l,o=!0)=>{var a;if(null==(a=t())||a.setModalProps({visible:e}),!l)return;if(o)return be[P(n)]=null,void(be[P(n)]=le(l));k(le(be[P(n)]),le(l))||(be[P(n)]=le(l))}}]}const Ce=e=>{const l=j(null),n=J(),t=j(""),o=()=>{const e=P(l);return e||M("useModalInner instance is undefined!"),e};return S((()=>{const l=be[P(t)];l&&e&&C(e)&&A((()=>{e(l)}))})),[(e,o)=>{O((()=>{l.value=null})),t.value=o,l.value=e,null==n||n.emit("register",e,o)},{changeLoading:(e=!0)=>{var l;null==(l=o())||l.setModalProps({loading:e})},getVisible:$((()=>ve[~~P(t)])),changeOkLoading:(e=!0)=>{var l;null==(l=o())||l.setModalProps({confirmLoading:e})},closeModal:()=>{var e;null==(e=o())||e.setModalProps({visible:!1})},setModalProps:e=>{var l;null==(l=o())||l.setModalProps(e)}}]};export{me as _,de as a,Ce as b,ye as u};
